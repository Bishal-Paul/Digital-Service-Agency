var FPROM=function(){"use strict";var c={},r="https://t.firstpromoter.com/tr",n="https://t.firstpromoter.com/get_details",a=null,i="_fprom_details",e="_fprom_tid",t="_fprom_ref",o=86400,f=1440,u=["fp_ref","fpr","via","a","_from","_by","deal","_go","_get"],d=!1;function l(){return window.fprom_loaded}function s(n){c=function(n,e){if(!e)return n;var t,i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}(c,n)}function _(){c.domain=function(){if(0===window.location.href.indexOf("localhost"))return"";var n=window.location.hostname.split(".");return n.slice(0).slice(-(4===n.length?3:2)).join(".")}(),c.test_mode="1"===x("test_mode"),c.test_mode||(c.cookie_tid=y(e),c.cookie_ref_id=y(t),c.details=m(y(i),!0)),c.referrer=document.referrer,c.url_ref_id=function(){var e;c.custom_param&&u.unshift(c.custom_param);return u.some(function(n){return e=x(n)}),e}(),c.ref_id=c.url_ref_id||c.cookie_ref_id,c.url=window.location.href,c.tid=c.cookie_tid,function(){{var n,e;c.cr_id=x("fpc"),c.cr_id&&(e=c.cr_id.split("--"),n=e[0],e=atob(e[1]),v(n),k(e),h(["fpc"]))}}()}function p(n,e,t,i){var o,r=(o=n,n=e,"withCredentials"in(e=new XMLHttpRequest)?e.open(o,n):"undefined"!=typeof XDomainRequest?(e=new XDomainRequest).open(o,n):e=null,e);r?(r.onload=function(){w(i)&&i(r)},r.onerror=function(){console.log("FirstPromoter: Error on CORS ajax request!"),w(i)&&i(r)},r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(function(n){if("object"!=typeof n&&"undefined"!=typeof console)return console.log("not a JSON object"),null;for(var e=encodeURIComponent,t="",i=Object.keys(n),o=0;o<i.length;o++)t+=e(i[o])+"="+e(n[i[o]]),o<i.length-1&&(t+="&");return t}(t))):console.log("CORS not supported")}function x(n){return new URLSearchParams(window.location.search).get(n)}function h(n=u){n.forEach(function(n){var e=new URLSearchParams(window.location.search);e.get(n)&&(e.delete(n),e=window.location.pathname+"?"+e.toString(),history.replaceState(null,null,e))})}function w(n){return n&&"function"==typeof n}function m(n,e=!1){var t;try{t=JSON.parse(n)}catch(n){}if(!e||t)return t||{}}function g(n,e,t){var i,o="",r="";t&&((i=new Date).setTime(i.getTime()+60*t*1e3),o="; expires="+i.toGMTString()),c.domain&&(r="; domain=."+c.domain),document.cookie=n+"="+escape(e)+o+r+"; path=/"}function y(n){for(var e,t=n+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(e=i[o];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(t))return unescape(e.substring(t.length,e.length))}return null}function v(n){n&&(g(e,n,a||o),c.cookie_tid=n,c.tid=n)}function k(n){n&&(g(t,n,a||o),c.cookie_ref_id=n,c.ref_id=n)}function O(n){var e,t={};for(e in n)n.hasOwnProperty(e)&&0!=e.indexOf("on")&&"details"!=e&&(t[e]=n[e]);return t}function R(n,e,t){if(s(e),"click"==n){if(!S())return;c.tid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=16*Math.random()|0;return("x"==n?e:3&e|8).toString(16)})}var i,o,e=O(c);e.event=n,o=t,F(r,i=e,function(n){n.cookie_life&&(a=1440*n.cookie_life),"click"==i.event&&(k(n.ref_id),v(n.tid),n.clean_url&&h())},function(n){n&&n.details?w(c.onDetailsFunc)&&c.onDetailsFunc(n):P(),w(o)&&o(n)})}function S(){return c.ref_id&&c.ref_id!=c.cookie_ref_id||!c.tid&&c.url_tracking}function F(n,e,t,i){!d&&e.tid&&(d=!0,p("POST",n,e,function(n){d=!1;var e=m(n.responseText);200==n.status&&t(e),w(i)&&i(e)}))}function P(){return c.include_details&&(!c.details||c.details.ref_id!=c.ref_id||S())&&(F(n,O(c),c.onDetailsFunc),1)}function b(t){if(!t||"function"!=typeof t)throw"Callback function is required!";c.onDetailsFunc=function(n){var e;(e=n.details)&&(c.details=e,delete c.include_details,g(i,JSON.stringify(e),f)),t(n.details)},c.include_details=!0,!P()&&c.details&&t(c.details)}var D={set:function(n){s(n)},crossDomain:function(n){!function(n){if(c.tid&&c.ref_id)for(var e,t=document.links,i=0;i<t.length;i++)t[i].href&&-1<t[i].href.indexOf(n)&&((e=new URL(t[i].href)).searchParams.set("fpc",c.tid+"--"+btoa(c.ref_id)),t[i].href=e)}(n)},getDetails:function(n){b(n)},onReady:function(n){n=n,l()?n(c):c.onReadyFunc=n},urlTracking:function(){R("click",{url_tracking:!0})},click:function(n,e){R("click",n,e)},referral:function(n,e){R("referral",n,e)},sale:function(n,e){R("sale",n,e)},init:function(n,e){n=n,e=e,l()||(_(),s(n),c.details&&delete c.include_details,window.fprom_loaded=!0,w(e)&&e(data),w(c.onReadyFunc)&&c.onReadyFunc(c))}};return{methods:D,_fpr:function(e){function n(){var n=Array.prototype.slice.call(arguments);n&&n[0]&&e[n[0]]&&e[n.shift()].apply(e,n)}for(;0<window.fpr.q.length;)n.apply(e,window.fpr.q.shift());return n}(D),data:c}}();window.fpr=window.FPROM._fpr;